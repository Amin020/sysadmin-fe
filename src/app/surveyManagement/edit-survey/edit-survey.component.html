<div class="builder-header justify-content-center">
  <a class="header-item lighten-4" [ngClass]='{"active-router":currentTab==="edit"}' (click)='currentTab="edit"'
    i18n>{{ 'surveyPage.EditSurvey' | translate }}</a>
  <a class="header-item lighten-4" [ngClass]='{"active-router":currentTab==="design"}'
    (click)='currentTab="design"'>{{ 'surveyPage.SurveyDesigner' | translate }}</a>
  <a class="header-item lighten-4" [ngClass]='{"active-router":currentTab==="test"}' (click)='currentTab="test"'
    *ngIf='selectedSurveyId !=0'>{{ 'surveyPage.TestSurvey' | translate }}</a>
  <a class="header-item  lighten-4" [ngClass]='{"active-router":currentTab==="translation"}'
    (click)='currentTab="translation"'>{{ 'surveyPage.Translation' | translate }}</a>
</div>
<!--Panel 1-->
<div [hidden]='currentTab !="edit"' class="card custom-tab">
  <form class="text-center pl-5 pr-5" [formGroup]='editForm' (ngSubmit)="UpdateSurvey(editForm)">
    <div class="row form-group">
      <div class="col-sm-3 col-xs-12 text-justify">
        <label class=" text-left ">{{ 'surveyPage.DepartmentName' | translate }}</label>
        <select class="browser-default custom-select " formControlName="department" name="department">
          <option *ngFor='let item of departmentList' [value]='item.id'>{{item.shortName}}
          </option>
        </select>
      </div>
      <div class="col-sm-3 col-xs-12 text-justify">
        <label class=" text-left ">{{ 'surveyPage.Status' | translate }}</label>
        <select class="browser-default custom-select " formControlName="status" name="status" disabled>
          <option value="INITIATED">{{ 'surveyPage.INITIATED' | translate }}</option>
          <option value="PUBLISHED">{{ 'surveyPage.PUBLISHED' | translate }}</option>
          <option value="CLOSED">{{ 'surveyPage.CLOSED' | translate }} </option>
        </select>
      </div>
      <div class="col-sm-3 col-xs-12 text-justify">
        <label class=" text-left ">{{ 'surveyPage.Name' | translate }}</label>
        <p class="font-small text-danger" *ngIf="validName">{{ 'surveyPage.required' | translate }} </p>
        <input type="text" formControlName="name" name="name" id="" class="form-control " placeholder="Name">
      </div>
      <div class="col-sm-3 col-xs-12 text-justify">
        <label class=" text-left ">{{ 'surveyPage.Title' | translate }}</label>
        <input type="text" formControlName="title" (change)='reflectOnSurveyModel()' name="title" id=""
          class="form-control " placeholder="title">
      </div>
    </div>
    <div class="row form-group">
      <div class="col-sm-3 col-xs-12 text-justify">
        <label class=" text-left ">{{ 'surveyPage.surveyType' | translate }}</label>
        <select class="browser-default custom-select " formControlName="surveyType" name="surveyType">
          <option value="SURVEY">{{ 'surveyPage.Survey' | translate }}</option>
          <option value="EXAM">{{ 'surveyPage.Exam' | translate }}</option>
          <option value="QUIZ">{{ 'surveyPage.Quiz' | translate }}</option>
          <option value="PRACTICE">{{ 'surveyPage.Practice' | translate }} </option>
          <option value="MARKET_RESEARCH">{{ 'surveyPage.Marketresearch' | translate }} </option>
        </select>
      </div>
      <div class="col-sm-3 col-xs-12 text-justify">
        <label class=" text-left ">{{ 'surveyPage.SurveyTheme' | translate }}</label>
        <select class="browser-default custom-select" formControlName="surveytheme" name="surveytheme">
          <option *ngFor='let item of themeList' [value]='item'>{{item}}
          </option>
        </select>
      </div>
      <div class="col-sm-3 col-xs-12 text-justify align-center">
        <mdb-checkbox [inline]='true' formControlName="public" name="public">
          {{ 'surveyPage.public' | translate }}</mdb-checkbox>
      </div>
      <div class="col-sm-3 col-xs-12 text-justify align-center">
        <mdb-checkbox [inline]='true' formControlName="allowMultipleSubmissions" name="allowMultipleSubmissions">
          {{ 'surveyPage.allowMultipleSubmissions' | translate }}</mdb-checkbox>
      </div>
    </div>
    <div class="row form-group">

      <div class="col-sm-3">
        <textarea class="md-textarea form-control " formControlName="completedSurveyTemplate"
          (change)='reflectOnSurveyModel()' id="exampleFormControlTextarea6"
          placeholder="Write Completed Survey Template here..." name="completedSurveyTemplate" rows="2" id="input_text"
          type="text" length="250" mdbCharCounter mdbInput></textarea>
      </div>
      <div class="col-sm-3 col-xs-12 text-justify"
        *ngIf="editForm.get('public').value == false && userGroupData?.length > 0">
        <label class=" text-left ">{{ 'surveyPage.AllowedGroup' | translate }}</label>
        <select class="browser-default custom-select " formControlName="userGroup"
          (ngModelChange)="onSelectGroup($event)" name="userGroup">
          <option *ngFor='let group of userGroupData let i=index' [value]='group.name'>{{group.name}}
          </option>
        </select>
      </div>
      <div class="col-sm-3 col-xs-12 text-justify"
        *ngIf="editForm.get('surveyType').value === 'EXAM' || editForm.get('surveyType').value === 'QUIZ'  || editForm.get('surveyType').value === 'PRACTICE' ">
        <label class=" text-left ">{{ 'surveyPage.TotalGrade' | translate }}</label>
        <input type="number" formControlName="totalGrade" name="totalGrade" id="" (change)='getTotalGrade()'
          class="form-control " placeholder="totalGrade">
      </div>
      <div class="col-sm-3 col-xs-12 text-justify"
        *ngIf="editForm.get('surveyType').value === 'EXAM' || editForm.get('surveyType').value === 'QUIZ' || editForm.get('surveyType').value === 'PRACTICE'">
        <label class=" text-left ">{{ 'surveyPage.TotalTimer' | translate }}</label>
        <input type="number" formControlName="totalTimer" name="totalTimer" id="" class="form-control "
          placeholder="totalTimer">
      </div>
    </div>
    <div class="row">
      <button mdbBtn class="waves-light text-justify full-width btn-large text-dark text-capitalize " type="button"
        (click)="Description.toggle()" mdbWavesEffect>
        {{ 'surveyPage.Description' | translate }}
      </button>
      <div mdbCollapse [isCollapsed]="true" class="full-width" #Description="bs-collapse">
        <angular-editor formControlName="description" name="description" (change)='reflectOnSurveyModel()'
          class=" col col-sm-9" type="text" id="" [config]="editorConfig" mdbInput></angular-editor>
      </div>
    </div>
    <div class="row">
      <button mdbBtn class="waves-light text-justify full-width btn-large text-dark text-capitalize " type="button"
        (click)="emailInvitationTemplate.toggle()" mdbWavesEffect>
        {{ 'surveyPage.EmailInvitationTemplate' | translate }}
      </button>
      <div mdbCollapse [isCollapsed]="true" class="full-width" #emailInvitationTemplate="bs-collapse">
        <angular-editor formControlName="emailInvitationTemplate" name="emailInvitationTemplate" class=" col col-sm-9"
          type="text" id="" [config]="editorConfig" mdbInput></angular-editor>
      </div>
    </div>
    <div class="row">
      <button mdbBtn class="waves-light text-justify full-width btn-large text-dark text-capitalize " type="button"
        (click)="logoImg.toggle()" mdbWavesEffect>
        {{ 'surveyPage.logo' | translate }}
      </button>

      <div mdbCollapse [isCollapsed]="true" class="full-width" #logoImg="bs-collapse">
        <div class=" col-sm-12 text-center">
          <img *ngIf="logo" class="width_height_200" [src]="logo" width="200" height="200" alt="">
        </div>
        <div class="row">
          <div class="col-sm-3 text-justify">
            <label class=" text-left ">{{ 'surveyPage.Position' | translate }}</label>
            <select class="browser-default custom-select" (change)='changeLogoPosition()' formControlName="logoPosition"
              name="logoPosition">
              <option value="-webkit-left">{{ 'surveyPage.Left' | translate }}</option>
              <option value="-webkit-center">{{ 'surveyPage.center' | translate }}</option>
              <option value="-webkit-right">{{ 'surveyPage.right' | translate }}</option>
            </select>
          </div>
          <div class="col-sm-4 text-justify">
            <label class=" text-left ">Height</label>
            <input type="number" formControlName="logoStyleHeight" name="height" class="form-control "
              placeholder="Height">
          </div>
          <div class="col-sm-4 text-justify">
            <label class=" text-left ">Width</label>
            <input type="number" formControlName="logoStyleWidth" name="width" class="form-control "
              placeholder="Width">
          </div>
        </div>
        <button type="button" mdbBtn color="primary" class="waves-light" data-toggle="modal" data-target="#basicExample"
          (click)="frame_2.show()" mdbWavesEffect>{{ 'surveyPage.Upload' | translate }}</button>
        <div mdbModal #frame_2="mdbModal" class="modal fade" id="frameModalTop" tabindex="-1" role="dialog"
          aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-notify modal-info" role="document">
            <!--Content-->
            <div class="modal-content text-center">
              <!--Header-->
              <div class="modal-header d-flex justify-content-center">
                <p class="heading">{{ 'surveyPage.ChangeLogo' | translate }}</p>
              </div>

              <!--Body-->
              <div class="modal-body">
                <a type="button" mdbBtn color="primary" class="waves-light"
                  mdbWavesEffect>{{ 'surveyPage.Upload' | translate }}
                  <mdb-icon fas icon="arrow-circle-up" class="ml-1"></mdb-icon>
                  <input type="file" mdbFileSelect (change)="onSelectLogo($event)">
                </a>
                <div class="logoImg text-center">
                  <img *ngIf="logo" class="width_height_200" [src]="logo" width="200" height="200" alt="">
                </div>
              </div>

              <!--Footer-->
              <div class="modal-footer justify-content-center">
                <a type="button" mdbBtn color="primary" outline="true" class="waves-light" mdbWavesEffect
                  data-dismiss="modal" (click)="frame_2.hide()">{{ 'surveyPage.Cancel' | translate }}</a>
              </div>
            </div>
            <!--/.Content-->
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <button mdbBtn class="waves-light text-justify full-width btn-large text-dark text-capitalize " type="button"
        (click)="backgroundImg.toggle()" mdbWavesEffect>
        {{ 'surveyPage.BackgroundImage' | translate }}
      </button>

      <div mdbCollapse [isCollapsed]="true" class="full-width" #backgroundImg="bs-collapse">
        <div class=" col-sm-12 text-center">
          <img *ngIf="surveyBackground" class="width_height_200" [src]="surveyBackground" width="200" height="200"
            alt="">
        </div>
        <button type="button" mdbBtn color="primary" class="waves-light" data-toggle="modal" data-target="#basicExample"
          (click)="frame.show()" mdbWavesEffect>{{ 'surveyPage.Upload' | translate }}</button>
        <div mdbModal #frame="mdbModal" class="modal fade" id="frameModalTop" tabindex="-1" role="dialog"
          aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-notify modal-info" role="document">
            <!--Content-->
            <div class="modal-content text-center">
              <!--Header-->
              <div class="modal-header d-flex justify-content-center">
                <p class="heading">{{ 'surveyPage.ChangeBackgroundImage' | translate }}</p>
              </div>

              <!--Body-->
              <div class="modal-body">
                <a type="button" mdbBtn color="primary" class="waves-light"
                  mdbWavesEffect>{{ 'surveyPage.Upload' | translate }}
                  <mdb-icon fas icon="arrow-circle-up" class="ml-1"></mdb-icon>
                  <input type="file" mdbFileSelect (change)="onSelectFile($event)">
                </a>
                <div class="logoImg text-center">
                  <img *ngIf="surveyBackground" class="width_height_200" [src]="surveyBackground" width="200"
                    height="200" alt="">
                </div>
              </div>

              <!--Footer-->
              <div class="modal-footer justify-content-center">
                <a type="button" mdbBtn color="primary" outline="true" class="waves-light" mdbWavesEffect
                  data-dismiss="modal" (click)="frame.hide()">{{ 'surveyPage.Cancel' | translate }}</a>
              </div>
            </div>
            <!--/.Content-->
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <button mdbBtn class="waves-light text-justify full-width btn-large text-dark text-capitalize " type="button"
        (click)="test.toggle()" mdbWavesEffect>
        {{ 'surveyPage.ReminderSettings' | translate }}
      </button>
      <div mdbCollapse [isCollapsed]="true" class="full-width" #test="bs-collapse">
        <div class="row form-group">
          <div class="col-sm-6">
            <div class="row">
              <div class="col col-sm-6 text-justify">
                <label class=" text-left mt-3 pl-4">{{ 'surveyPage.AutoReminderEnabled' | translate }}
                </label>
              </div>
              <div class="col col-sm-6 text-justify">
                <mdb-checkbox formControlName="sendAutoReminders" name="sendAutoReminders" class="" [default]="true">
                </mdb-checkbox>
              </div>
            </div>
          </div>
        </div>
        <div class='col-sm-12' *ngIf='editForm.controls["sendAutoReminders"].value==true'>
          <div class="row form-group">
            <div class="col-sm-6 col-xs-12 text-justify">
              <label class=" text-left ">{{ 'surveyPage.occurs' | translate }}</label>
              <select formControlName="autoRemindersFrequency" name="autoRemindersFrequency"
                class="browser-default custom-select ">
                <option value="WEEKLY" selected="selected">{{ 'surveyPage.weekly' | translate }}
                </option>
                <option value="MONTHLY">{{ 'surveyPage.monthly' | translate }}</option>
              </select>
            </div>
            <div class="col-sm-6 col-xs-12 text-justify"
              *ngIf='editForm.controls["autoRemindersFrequency"].value=="WEEKLY"'>
              <label class=" text-left ">{{ 'surveyPage.RecursEvery' | translate }}
                <span class="ml-5 text-right font-small font-weight-normal">{{ 'surveyPage.Week' | translate }}</span>
              </label>
              <select id="x" formControlName="autoRemindersWeeklyOccurrence" name="autoRemindersWeeklyOccurrence"
                class="browser-default custom-select ">
                <option value="0">0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="1">3</option>
                <option value="2">4</option>
              </select>
            </div>
            <!-------------- Monthly Box  -------->
            <div class="col-sm-3 col-xs-12 text-justify"
              [hidden]="editForm.get('autoRemindersFrequency').value !== 'MONTHLY'">
              <label class=" text-left ">{{ 'surveyPage.Day' | translate }} </label>
              <select formControlName="autoRemindersDayOfMonth" name="autoRemindersDayOfMonth"
                class="browser-default custom-select ">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
                <option value="19">19</option>
                <option value="20">20</option>
                <option value="21">21</option>
                <option value="22">22</option>
                <option value="23">23</option>
                <option value="24">24</option>
                <option value="25">25</option>
                <option value="26">26</option>
                <option value="27">27</option>
                <option value="28">28</option>
                <option value="29">29</option>
                <option value="30">30</option>
              </select>
            </div>
            <div class="col col-sm-3 col-xs-12 text-justify"
              [hidden]="editForm.get('autoRemindersFrequency').value !== 'MONTHLY'">
              <label class=" text-left ">{{ 'surveyPage.OfEvery' | translate }} <span
                  class="ml-5 text-right font-small font-weight-normal">{{ 'surveyPage.Month' | translate }}</span></label>
              <select id="autoRemindersMonthlyOccurrence" formControlName="autoRemindersMonthlyOccurrence"
                name="autoRemindersMonthlyOccurrence" class="browser-default custom-select ">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
              </select>
            </div>
          </div>
          <!-------- Start Weekly box ------>
          <div class="full-width" [hidden]="editForm.get('autoRemindersFrequency').value !== 'WEEKLY'">
            <div class="row col-sm-12">
              <div class="col col-sm-2 text-justify">
                <label class=" text-left  mt-3">{{ 'surveyPage.On' | translate }}</label>
              </div>
              <div class="col-col-sm-1 m-3 pl-5 ml-5">
                <mdb-checkbox (click)="onDayChange($event)" name="MON" [checked]="isChecked('MON')">
                  {{ 'surveyPage.Monday' | translate }}</mdb-checkbox>
              </div>
              <div class="col-col-sm-1 m-3">
                <mdb-checkbox (click)="onDayChange($event)" name="TUE" [checked]="isChecked('TUE')">
                  {{ 'surveyPage.Tuesday' | translate }}</mdb-checkbox>
              </div>
              <div class="col-col-sm-1 m-3">
                <mdb-checkbox (click)="onDayChange($event)" name="WED" [checked]="isChecked('WED')">
                  {{ 'surveyPage.Wednesday' | translate }}</mdb-checkbox>
              </div>
              <div class="col-col-sm-1 m-3">
                <mdb-checkbox (click)="onDayChange($event)" name="THU" [checked]="isChecked('THU')">
                  {{ 'surveyPage.Thursday' | translate }}</mdb-checkbox>
              </div>
              <div class="col-col-sm-1 m-3">
                <mdb-checkbox (click)="onDayChange($event)" name="FRI" [checked]="isChecked('FRI')">
                  {{ 'surveyPage.Friday' | translate }}</mdb-checkbox>
              </div>
              <div class="col-col-sm-1 m-3">
                <mdb-checkbox (click)="onDayChange($event)" name="SAT" [checked]="isChecked('SAT')">
                  {{ 'surveyPage.Saturday' | translate }}</mdb-checkbox>
              </div>
              <div class="col-col-sm-1 m-3">
                <mdb-checkbox (click)="onDayChange($event)" name="SUN" [checked]="isChecked('SUN')">
                  {{ 'surveyPage.Sunday' | translate }}</mdb-checkbox>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
    <div class="">
      <button type="submit" color="" class="btn btn-warning" (click)='editForm.controls["status"].setValue(
        "PUBLISHED")' *ngIf='editable && selectedSurveyId !=="0"  && isCopy ==null'
        [disabled]='editForm.invalid || loading'>
        {{ 'surveyPage.publish' | translate }}
      </button>
      <button type="submit" color="" class="btn btn-primary "
        *ngIf='editable && selectedSurveyId !=="0"  && isCopy ==null' [disabled]='editForm.invalid || loading'>
        {{ 'surveyPage.Update' | translate }}
      </button>
      <button type="submit" color="" class="btn btn-primary " *ngIf='selectedSurveyId == "0" && isCopy ==null'
        [disabled]='editForm.invalid || loading'> {{ 'surveyPage.Create' | translate }}
      </button>
      <button type="submit" color="" class="btn btn-primary " *ngIf='selectedSurveyId != "0" && isCopy !=null'
        [disabled]='editForm.invalid || loading'> {{ 'surveyPage.copy' | translate }}
      </button>
      <button type="submit" color="" class="btn btn-warning" (click)='editForm.controls["status"].setValue(
      "CLOSED");UpdateSurvey(editForm)'
        *ngIf='editForm.controls["status"].value == "PUBLISHED" && selectedSurveyId !=="0"  && isCopy ==null'
        [disabled]='editForm.invalid || loading'>
        {{ 'surveyPage.CLOSED' | translate }}
      </button>
      <button type="" (click)="goTosurveyList()" color="" class="btn btn-danger ">{{ 'surveyPage.Cancel' | translate }}
      </button>
    </div>
  </form>
</div>
<!--Panel 2-->
<div *ngIf='currentTab =="design"' class="card custom-tab">
  <div class="page-content" *ngIf='surveyData?.surveyBody'>
    <div class="design-container col-sm-12">
      <div class="col-sm-3">
        <app-builder-tool-box [surveyId]="selectedSurveyId"></app-builder-tool-box>
      </div>
      <div class="col-sm-7">
        <app-builder-sketch-page [logo]='logo' [background]='surveyBackground' [surveyLogoPosition]='surveyLogoPosition'
          [surveyId]="selectedSurveyId"
          [logoStyle]='{height:editForm.get("logoStyleHeight").value,width:editForm.get("logoStyleWidth").value}'>
        </app-builder-sketch-page>
      </div>
      <div class="col-sm-2">
        <app-builder-settings [surveyId]="selectedSurveyId"></app-builder-settings>
      </div>
    </div>
  </div>
</div>

<div *ngIf='currentTab=="test" && selectedSurveyId !=0' class="card custom-tab">
  <app-builder-test></app-builder-test>
</div>
<div *ngIf='currentTab=="translation"' data-aos="fade-up" data-aos-duration="1000" class="card custom-tab">
  <app-builder-translation [optionsSelect]='optionsSelect' [addedLanguagesList]='addedLanguagesList'
    [translatedLanguagesList]='translatedLanguagesList'></app-builder-translation>
</div>